# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java

trigger:
 branches:
  include:
    - master
  
pool:
  vmImage: 'ubuntu-latest'

stages:
- stage: ci_stage
  displayName: CI
  jobs:
  - job: Build_AEM
    displayName: Build AEM
    steps:
      # build
      - task: Maven@3
        displayName: Maven build task
        inputs:
          mavenPomFile: 'pom.xml'
          mavenOptions: '-Xmx3072m'
          javaHomeOption: 'JDKVersion'
          jdkVersionOption: '1.8'
          jdkArchitectureOption: 'x64'
          goals: 'package'

        # publish build artifact
      - task: PublishPipelineArtifact@1
        displayName: 'Publish Build Artifact'
        inputs:
          targetPath: '$(Pipeline.Workspace)/s/target/ODPRoot-1.0-SNAPSHOT.jar' 
          artifactName: 'ODPRoot-1.0-SNAPSHOT.jar'   
  